!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).ReactQueryPersistLocalStorageExperimental={})}(this,(function(e){"use strict";function t(){return(t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function a(e){return e.state.isPaused}function r(e){return"success"===e.state.status}function n(e,t){var n,o,u=[],i=[];if(!1!==(null==(n=t=t||{})?void 0:n.dehydrateMutations)){var s=t.shouldDehydrateMutation||a;e.getMutationCache().getAll().forEach((function(e){s(e)&&u.push(function(e){return{mutationKey:e.options.mutationKey,state:e.state}}(e))}))}if(!1!==(null==(o=t)?void 0:o.dehydrateQueries)){var c=t.shouldDehydrateQuery||r;e.getQueryCache().getAll().forEach((function(e){c(e)&&i.push(function(e){return{cacheTime:(t=e.cacheTime,t===1/0?-1:t),state:e.state,queryKey:e.queryKey,queryHash:e.queryHash};var t}(e))}))}return{mutations:u,queries:i}}e.persistWithLocalStorage=function(e,a){var r=void 0===a?{}:a,o=r.localStorageKey,u=void 0===o?"REACT_QUERY_OFFLINE_CACHE":o,i=r.throttleTime,s=void 0===i?1e3:i,c=r.maxAge,l=void 0===c?864e5:c,f=r.buster,d=void 0===f?"":f;if("undefined"!=typeof window){var y=function(e,t){void 0===t&&(t=100);var a=null;return function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];null===a&&(a=setTimeout((function(){e.apply(void 0,n),a=null}),t))}}((function(){var t={buster:d,timestamp:Date.now(),cacheState:n(e)};localStorage.setItem(u,JSON.stringify(t))}),s);e.getQueryCache().subscribe(y);var h=localStorage.getItem(u);if(!h)return;var v=JSON.parse(h);if(v.timestamp){var m=Date.now()-v.timestamp>l,p=v.buster!==d;m||p?localStorage.removeItem(u):function(e,a,r){if("object"==typeof a&&null!==a){var n=e.getMutationCache(),o=e.getQueryCache(),u=a.mutations||[],i=a.queries||[];u.forEach((function(a){var o;n.build(e,t({},null==r||null==(o=r.defaultOptions)?void 0:o.mutations,{mutationKey:a.mutationKey}),a.state)})),i.forEach((function(a){var n,u,i=o.get(a.queryHash);i?i.state.dataUpdatedAt<a.state.dataUpdatedAt&&i.setState(a.state):o.build(e,t({},null==r||null==(n=r.defaultOptions)?void 0:n.queries,{queryKey:a.queryKey,queryHash:a.queryHash,cacheTime:(u=a.cacheTime,-1===u?1/0:u)}),a.state)}))}}(e,v.cacheState)}else localStorage.removeItem(u)}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=persist-localstorage-experimental.production.min.js.map
